{% extends "layout.njk" %}

{% block content %}
  {% if mode == "edit" %}
    <h2>Edit Post</h2>
  {% else %}
    <h2>New Post</h2>
  {% endif %}

  <form method="POST">
    <label for="title">Title</label>
    <input
      type="text"
      id="title"
      name="title"
      placeholder="Enter post title"
      required
      style="max-width: 400px;"
    >

    <label for="editor">Content</label>
    <div id="editor"></div>
    <input type="hidden" name="content" id="hiddenContent">

    <button type="submit" class="contrast">
      {% if mode == "edit" %}Update{% else %}Create{% endif %}
    </button>
  </form>

  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <style>
    #editor {
      background: #fff;
      color: #000;
      height: 150px;
      border: 1px solid var(--muted-border-color);
      border-radius: var(--border-radius);
      margin-bottom: 1rem;
      overflow-y: auto;
    }

    .ql-toolbar {
      border-radius: var(--border-radius) var(--border-radius) 0 0;
    }

    .ql-container {
      border-radius: 0 0 var(--border-radius) var(--border-radius);
    }

    button.contrast {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 0.5rem 1.2rem;
      border-radius: var(--border-radius);
      cursor: pointer;
    }

    button.contrast:hover {
      background: #005fcc;
    }
  </style>

  <script>
    const quill = new Quill("#editor", { theme: "snow" });
    const form = document.querySelector("form");
    form.addEventListener("submit", () => {
      document.getElementById("hiddenContent").value = quill.root.innerHTML;
    });
  </script>
{% endblock %}
